\documentclass[uplatex, 11pt, a4j, dvipdfmx]{jsarticle}

%------------------------------------------------------------------------
% パッケージ
%------------------------------------------------------------------------
\usepackage{./preambles/ownpack}

\newcommand{\comb}[2]{\begin{pmatrix} #1 \\ #2 \end{pmatrix}}


\title{メビウス関数(M\"obius function)}
\author{}
\date{}

% -----------------------------------------------------------------------
% 本文
% -----------------------------------------------------------------------

\begin{document}

  \maketitle
  \tableofcontents

  \section{メビウス関数(M\"obius function)}
    \begin{definition}{メビウス関数(M\"obius function)}
      正の整数$n$に対して以下の関数
      \begin{equation}
        \mu(n) = \begin{cases}
          0,      & \text{$n$が$1$以外の平方因子をもつとき} \\
          (-1)^k, & \text{$n$が$k$個の異なる素因数を持つとき}
        \end{cases}
      \end{equation}
      をメイビウス関数とする。
      また、$\mu(1) = 1$とする。
    \end{definition}

    \begin{theorem}
      任意の互いに素な正の整数$m, n$に対して$\mu(m) \mu(n) = \mu(m n)$が成立する。
    \end{theorem}

    \begin{theorem}
      正の整数$2 \ge 2$に対して、
      \begin{equation}
        \sum_{d | n} \mu(d) = 0
      \end{equation}
      となる。
    \end{theorem}
    \begin{proof}
      $n$の標準素因数分解$n = p_1^{\alpha_1} p_2^{\alpha_2} \cdots p_k^{\alpha_k}$と書くとする。
      ここで$n$のある約数$d$に対して$\mu(d) \neq 0$となる必要十分条件は$d = p_1^{\delta_1} p_2^{\delta_2} \cdots p_k^{\delta_k}, \; (\delta_i \in \{ 0, 1 \}, 1 \le i \le k)$と書けることである。
      したがって
      \begin{equation}
        \sum_{d | n} \mu(d) = \sum_{\delta_i \in \{0, 1 \}} \mu(p_1^{\delta_1} p_2^{\delta_2} \cdots p_k^{\delta_k})
                            = \sum_{\delta_i \in \{0, 1 \}} (-1)^{\delta_1 + \delta_2 + \cdots + \delta_k}
                            = \sum_{i=0}^k (-1)^k \comb{k}{i}
      \end{equation}
      となる。
      二項定理から
      \begin{equation}
        \sum_{i=0}^k (-1)^k \comb{k}{i} = (1 - 1)^k = 0
      \end{equation}
      が示される。
    \end{proof}


  \section{メビウスの反転公式(M\"obius inversion formula)}
    \begin{theorem}{メビウスの反転公式(M\"obius inversion formula)}
      正の整数集合を定義域とする関数$f(n), g(n)$に対して%TODO: 終域は?
      \begin{equation}
        f(n) = \sum_{d | n} g(d) \Leftrightarrow g(n) = \sum_{d | n} \mu(\frac{n}{d}) f(d)
      \end{equation}
      が成り立つ。
      この関係式をメビウスの反転公式という。
    \end{theorem}
    \begin{proof}
      まず$f(n) = \sum_{d | n} g(d) \Leftarrow g(n) = \sum_{d | n} \mu(\frac{n}{d}) f(d)$を示す。
      この左辺の式を代入することで、
      \begin{align}
        g(n) &= \sum_{d | n} \func{\mu}{\frac{n}{d}} f(d) \\
             &= \sum_{d | n} \func{\mu}{\frac{n}{d}} \sum_{d' | d} g(d') \\
             &= \sum_{d | n} \sum_{d' | d} g(d') \func{\mu}{\frac{n}{d}} \\
             &= \sum_{d' | n} \sum_{d' | d | n} g(d') \func{\mu}{\frac{n}{d}} \\
             &= \sum_{d' | n} g(d') \sum_{d' | d | n} \func{\mu}{\frac{n}{d}}
      \end{align}
      となる。
      ここで$m = \frac{n}{d'}, d^\ast = \frac{d}{d'}$とおくと、$d^\ast | m$を満たす$d^\ast$の集合と$d' | d | m$を満たす$d$の集合は一体一対応する。
      さらに、$\frac{n}{d} = \frac{m}{d^\ast}$であるため
      \begin{equation}
        \sum_{d' | n} g(d') \sum_{d' | d | n} \func{\mu}{\frac{n}{d}} = \sum_{d' | n} g(d') \sum_{d^\ast | m} \func{\mu}{\frac{m}{d^\ast}}
      \end{equation}
      となる。
      前述の定理から
      \begin{equation}
        \func{\mu}{\frac{m}{d^\ast}} = \begin{cases}
          0, & m \neq 0 \\
          1, & m  =   0
        \end{cases}
      \end{equation}
      であるため
      \begin{equation}
        \sum_{d' | n} g(d') \sum_{d^\ast | m} \func{\mu}{\frac{m}{d^\ast}} = g(n)
      \end{equation}
      となり示された。
      同様にして$f(n) = \sum_{d | n} g(d) \Rightarrow g(n) = \sum_{d | n} \mu(\frac{n}{d}) f(d)$も示される。
    \end{proof}



\end{document}

